(()=>{"use strict";var t={d:(e,n)=>{for(var r in n)t.o(n,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:n[r]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)};t.d({},{eI:()=>k,ob:()=>J,bF:()=>C,Dg:()=>A});var e=function(t){t.classList.add("popup_is-opened"),t.addEventListener("click",r),document.addEventListener("keydown",o)},n=function(t){t.classList.remove("popup_is-opened"),t.removeEventListener("click",r),document.removeEventListener("keydown",o)},r=function(t){(t.target===t.currentTarget||t.target.classList.contains("popup__close"))&&n(document.querySelector(".popup_is-opened"))},o=function(t){"Escape"===t.key&&n(document.querySelector(".popup_is-opened"))},c="3150b793-2139-4a81-bc54-adc352f9350d",a="https://nomoreparties.co/v1/wff-cohort-10",i=function(t){if(t.ok)return t.json();throw new Error("Ошибка: ".concat(t.status))},u=function(t,e,n,r,o){var i=document.querySelector("#card-template").content.querySelector(".card").cloneNode(!0),u=i.querySelector(".card__delete-button"),s=i.querySelector(".card__container-like"),p=s.querySelector(".card__like-button"),d="card__like-button_is-active",_=s.querySelector(".card__quantity-like"),f=i.querySelector(".card__image");return f.src=t.link,f.alt=t.name,i.querySelector(".card__title").textContent=t.name,f.addEventListener("click",o),p.addEventListener("click",(function(){r(p,t,d)})),e===t.owner._id?u.addEventListener("click",(function(){var e;n(i),e=t._id,fetch("".concat(a,"/cards/").concat(e),{method:"DELETE",headers:{authorization:c}})})):u.remove(),t.likes.forEach((function(t){e===t._id&&p.classList.add(d)})),l(_,t.likes),i},s=function(t){t.remove()},p=function(t,e,n){t.classList.contains(n)?(function(t){fetch("".concat(a,"/cards/likes/").concat(t),{method:"DELETE",headers:{authorization:c}})}(e._id),t.classList.remove(n)):(function(t){fetch("".concat(a,"/cards/likes/").concat(t),{method:"PUT",headers:{authorization:c}})}(e._id),t.classList.add(n))},l=function(t,e){e.length>=1?(t.classList.add("card__quantity-like_active"),t.textContent="".concat(e.length)):t.classList.remove("card__quantity-like_active")},d=document.querySelector(".popup__input_type_card-name"),_=document.querySelector(".popup__input_type_url"),f=document.querySelector(".popup__input_type_name"),y=document.querySelector(".popup__input_type_description"),m=document.querySelector(".profile__title"),v=document.querySelector(".profile__description"),h=document.querySelector(".popup__input_type_url_avatar"),S=document.querySelector(".profile__image-avatar"),b=document.querySelector(".popup__button"),q=Array.from(document.querySelectorAll(".popup__input")),E=function(t,e){!function(t){return t.some((function(t){return!t.validity.valid}))}(t)?e.classList.remove("popup__button_disabled"):e.classList.add("popup__button_disabled")},L=function(){b.textContent="Сохранить";var t=Array.from(document.querySelectorAll(".popup__input-error"));E(q,b),t.forEach((function(t){t.innerText=""})),q.forEach((function(t){return t.classList.remove("popup__input_type_error")}))};function g(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var k=document.querySelector(".places__list"),C=document.querySelector(".popup_type_edit"),w=document.querySelector(".profile__edit-button"),A=document.querySelector(".popup_type_new-card"),x=document.querySelector(".profile__add-button"),T=document.forms["edit-profile"],j=document.forms["new-place"],O=document.forms.avatar,z=document.querySelector(".popup_type_image"),D=z.querySelector(".popup__image"),P=z.querySelector(".popup__caption"),N=function(t){var n=t.target;D.src=n.src,D.alt=P.textContent=n.alt,e(z)},I=document.querySelector(".profile__image"),J=document.querySelector(".popup_type_avatar");I.addEventListener("click",(function(){O.reset(),L(),e(J)})),w.addEventListener("click",(function(){L(),e(C),f.value=m.textContent,y.value=v.textContent})),Array.from(document.querySelectorAll(".popup__form")).forEach((function(t){t.addEventListener("submit",(function(t){t.preventDefault(),b.textContent="Сохранение..."})),function(t){var e=Array.from(t.querySelectorAll(".popup__input"));E(e,b),e.forEach((function(n){n.addEventListener("input",(function(){!function(t,e){e.validity.patternMismatch?e.setCustomValidity(e.dataset.errorMessage):e.setCustomValidity(""),e.validity.valid?function(t,e){var n=t.querySelector(".".concat(e.id,"-error"));e.classList.remove("popup__input_type_error"),n.classList.remove("popup__input-error_active"),n.textContent=""}(t,e):function(t,e,n){var r=t.querySelector(".".concat(e.id,"-error"));e.classList.add("popup__input_type_error"),r.textContent=n,r.classList.add("popup__input-error_active")}(t,e,e.validationMessage)}(t,n),E(e,b)}))}))}(t)})),x.addEventListener("click",(function(){j.reset(),L(),e(A)})),Promise.all([fetch("".concat(a,"/cards"),{headers:{authorization:c}}).then(i),fetch("".concat(a,"/users/me"),{headers:{authorization:c,"Content-Type":"application/json"}}).then(i)]).then((function(t){var e,n,r,o,c=(n=2,function(t){if(Array.isArray(t))return t}(e=t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,c,a,i=[],u=!0,s=!1;try{if(c=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=c.call(n)).done)&&(i.push(r.value),i.length!==e);u=!0);}catch(t){s=!0,o=t}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(s)throw o}}return i}}(e,n)||function(t,e){if(t){if("string"==typeof t)return g(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?g(t,e):void 0}}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}());r=c[0],o=c[1]._id,r.forEach((function(t){var e=u(t,o,s,p,N);k.append(e)}))})).catch((function(t){throw new Error("Ошибка: ".concat(t.status))})),fetch("".concat(a,"/users/me"),{headers:{authorization:c,"Content-Type":"application/json"},body:JSON.stringify()}).then(i).then((function(t){var e;!function(t){m.textContent=t.name,v.textContent=t.about}(t),e=t,S.src=e.avatar})).catch((function(t){throw new Error("Ошибка: ".concat(t.status))})),j.addEventListener("submit",(function(t){var e;t.preventDefault(),(e={name:d.value,link:_.value},fetch("".concat(a,"/cards"),{method:"POST",headers:{authorization:c,"Content-Type":"application/json"},body:JSON.stringify(e)}).then(i)).then((function(t){k.prepend(u(t))})).catch((function(t){throw new Error("Ошибка: ".concat(t.status))})),n(A)})),T.addEventListener("submit",(function(t){var e;t.preventDefault(),(e={name:f.value,about:y.value},fetch("".concat(a,"/users/me"),{method:"PATCH",headers:{authorization:c,"Content-Type":"application/json"},body:JSON.stringify(e)}).then(i)).then((function(t){m.textContent=t.name,v.textContent=t.about})).catch((function(t){throw new Error("Ошибка: ".concat(t.status))})),n(C)})),O.addEventListener("submit",(function(t){var e;t.preventDefault(),(e=h.value,fetch("".concat(a,"/users/me/avatar"),{method:"PATCH",headers:{authorization:c,"Content-Type":"application/json"},body:JSON.stringify({avatar:e})}).then(i)).then((function(t){S.src=t.avatar})),n(J)}))})();
//# sourceMappingURL=main.js.map