(()=>{"use strict";var t={d:(e,n)=>{for(var r in n)t.o(n,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:n[r]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)};t.d({},{eI:()=>A,Db:()=>N,ob:()=>H,bF:()=>x,Dg:()=>T});var e=function(t){t.classList.add("popup_is-opened"),t.addEventListener("click",r),document.addEventListener("keydown",o)},n=function(t){t.classList.remove("popup_is-opened"),t.removeEventListener("click",r),document.removeEventListener("keydown",o)},r=function(t){(t.target===t.currentTarget||t.target.classList.contains("popup__close"))&&n(document.querySelector(".popup_is-opened"))},o=function(t){"Escape"===t.key&&n(document.querySelector(".popup_is-opened"))},c="3150b793-2139-4a81-bc54-adc352f9350d",a="https://nomoreparties.co/v1/wff-cohort-10",i=function(t){if(t.ok)return t.json();throw new Error("Ошибка: ".concat(t.status))},u=function(t){return fetch("".concat(a,"/cards/likes/").concat(t),{method:"PUT",headers:{authorization:c}}).then(i)},l=function(t){return fetch("".concat(a,"/cards/likes/").concat(t),{method:"DELETE",headers:{authorization:c}}).then(i)},s=function(t,e,n,r,o){var c=document.querySelector("#card-template").content.querySelector(".card").cloneNode(!0),a=c.querySelector(".card__delete-button"),i=c.querySelector(".card__container-like"),u=i.querySelector(".card__like-button"),l="card__like-button_is-active",s=i.querySelector(".card__quantity-like"),d=c.querySelector(".card__image");return d.src=t.link,d.alt=t.name,c.querySelector(".card__title").textContent=t.name,d.addEventListener("click",o),u.addEventListener("click",(function(){r(u,t,l)})),e===t.owner._id?a.addEventListener("click",(function(){n(t._id,c)})):a.remove(),t.likes.some((function(t){return t._id===e}))&&u.classList.add(l),f(s,t.likes),c},d=function(t,e){var n;(n=t,fetch("".concat(a,"/cards/").concat(n),{method:"DELETE",headers:{authorization:c}})).then((function(){return function(t){t.remove()}(e)})).catch((function(t){throw new Error("Ошибка: ".concat(t.status))}))},p=function(t,e,n){(t.classList.contains(n)?l:u)(e._id).then((function(e){quantityLike.textContent=e.likes.length,t.classList.toggle(n)})).catch((function(t){throw new Error("Ошибка: ".concat(t.status))}))},f=function(t,e){e.length>=1?(t.classList.add("card__quantity-like_active"),t.textContent=e.length):t.classList.remove("card__quantity-like_active")},_=document.querySelector(".popup__input_type_card-name"),y=document.querySelector(".popup__input_type_url"),m=document.querySelector(".popup__input_type_name"),v=document.querySelector(".popup__input_type_description"),h=document.querySelector(".profile__title"),S=document.querySelector(".profile__description"),b=document.querySelector(".popup__input_type_url_avatar"),q=document.querySelector(".profile__image-avatar"),E=function(t){h.textContent=t.name,S.textContent=t.about},L=function(t,e,n){var r=t.querySelector(".".concat(e.id,"-error"));e.classList.remove(n.inputErrorClass),r.classList.remove(n.displayError),r.textContent=""},g=function(t,e){t.disabled=!0,t.classList.add(e.inactiveButtonClass)},C=function(t,e,n){!function(t){return t.some((function(t){return!t.validity.valid}))}(t)?(e.disabled=!1,e.classList.remove(n.inactiveButtonClass)):g(e,n)},k=function(t,e){var n=Array.from(t.querySelectorAll(e.inputSelector)),r=t.querySelector(e.submitButtonSelector);g(r,e),r.textContent="Сохранить",n.forEach((function(n){return L(t,n,e)}))};function w(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var A=document.querySelector(".places__list"),x=document.querySelector(".popup_type_edit"),j=document.querySelector(".profile__edit-button"),T=document.querySelector(".popup_type_new-card"),O=document.querySelector(".profile__add-button"),z=document.forms["edit-profile"],D=document.forms["new-place"],B=document.forms.avatar,P=document.querySelector(".popup_type_image"),I=P.querySelector(".popup__image"),M=P.querySelector(".popup__caption"),N=function(t){var n=t.target;I.src=n.src,I.alt=M.textContent=n.alt,e(P)},J=document.querySelector(".profile__image"),H=document.querySelector(".popup_type_avatar"),U={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",displayError:"popup__input-error_active"};J.addEventListener("click",(function(){B.reset(),k(B,U),e(H)})),j.addEventListener("click",(function(){k(z,U),e(x),m.value=h.textContent,v.value=S.textContent})),O.addEventListener("click",(function(){D.reset(),k(D,U),e(T)})),function(t){Array.from(document.querySelectorAll(t.formSelector)).forEach((function(e){e.addEventListener("submit",(function(n){n.preventDefault(),e.querySelector(t.submitButtonSelector).textContent="Сохранение..."})),function(t,e){var n=Array.from(t.querySelectorAll(e.inputSelector)),r=t.querySelector(e.submitButtonSelector);C(n,r,e),n.forEach((function(o){o.addEventListener("input",(function(){!function(t,e,n){e.validity.patternMismatch?e.setCustomValidity(e.dataset.errorMessage):e.setCustomValidity(""),e.validity.valid?L(t,e,n):function(t,e,n,r){var o=t.querySelector(".".concat(e.id,"-error"));e.classList.add(r.inputErrorClass),o.textContent=n,o.classList.add(r.displayError)}(t,e,e.validationMessage,n)}(t,o,e),C(n,r,e)}))}))}(e,t)}))}(U),Promise.all([fetch("".concat(a,"/cards"),{headers:{authorization:c}}).then(i),fetch("".concat(a,"/users/me"),{headers:{authorization:c,"Content-Type":"application/json"}}).then(i)]).then((function(t){var e,n,r,o=(r=2,function(t){if(Array.isArray(t))return t}(n=t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,c,a,i=[],u=!0,l=!1;try{if(c=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=c.call(n)).done)&&(i.push(r.value),i.length!==e);u=!0);}catch(t){l=!0,o=t}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return i}}(n,r)||function(t,e){if(t){if("string"==typeof t)return w(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?w(t,e):void 0}}(n,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),c=o[0],a=o[1];!function(t,e){t.forEach((function(t){var n=s(t,e,d,p,N);A.append(n)}))}(c,a._id),E(a),e=a,q.src=e.avatar})).catch((function(t){throw new Error("Ошибка: ".concat(t.status))})),D.addEventListener("submit",(function(t){var e;t.preventDefault(),(e={name:_.value,link:y.value},fetch("".concat(a,"/cards"),{method:"POST",headers:{authorization:c,"Content-Type":"application/json"},body:JSON.stringify(e)}).then(i)).then((function(t){A.prepend(s(t,t.owner._id,d,p,N))})).catch((function(t){throw new Error("Ошибка: ".concat(t.status))})),n(T)})),z.addEventListener("submit",(function(t){var e;t.preventDefault(),(e={name:m.value,about:v.value},fetch("".concat(a,"/users/me"),{method:"PATCH",headers:{authorization:c,"Content-Type":"application/json"},body:JSON.stringify(e)}).then(i)).then((function(t){E(t)})).catch((function(t){throw new Error("Ошибка: ".concat(t.status))})),n(x)})),B.addEventListener("submit",(function(t){var e;t.preventDefault(),(e=b.value,fetch("".concat(a,"/users/me/avatar"),{method:"PATCH",headers:{authorization:c,"Content-Type":"application/json"},body:JSON.stringify({avatar:e})}).then(i)).then((function(t){q.src=t.avatar})).catch((function(t){throw new Error("Ошибка: ".concat(t.status))})),n(H)}))})();
//# sourceMappingURL=main.js.map